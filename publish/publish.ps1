# Script to build the WPF and CLI app, sign the executables and build the installer

Param (
    [switch]$dev,
    [switch]$preview
)

if ($preview) {
    $WpfExeName = "2FAGuard-Preview.exe"
    $PortableExeName = "2FAGuard-Portable-Preview.exe"
    $CliExeName = "2fa-Preview.exe"

    $env:PREVIEW = "1"    
}
else {
    $WpfExeName = "2FAGuard.exe"
    $PortableExeName = "2FAGuard-Portable.exe"
    $CliExeName = "2fa.exe"
}

function Confirm-Requirements {
    # Check if current directory is the publish directory
    if (-not (Test-Path .\publish.ps1)) {
        Write-Host "Please run the script from the publish directory"
        Exit
    }
    # Check if Inno Setup 6 is installed
    if (-not (Test-Path "C:\Program Files (x86)\Inno Setup 6\ISCC.exe")) {
        Write-Host "Inno Setup 6 is required to build the installer"
        Exit
    }
    # Check if the command sign tool is available
    if (-not (Get-Command "signtool.exe" -errorAction SilentlyContinue)) {
        Write-Host "SignTool is required to sign the executables"
        Exit
    }
    # Check if the command dotnet is available
    if (-not (Get-Command "dotnet" -errorAction SilentlyContinue)) {
        Write-Host "Dotnet is required to build the executables"
        Exit
    }
    # Create required directories
    if (-not (Test-Path .\bin)) {
        New-Item -ItemType Directory -Path .\bin
    }
}

function Invoke-Tests {
    Set-Location ../Guard.Test
    dotnet test
    Set-Location ../publish
}

function Build-WPF-App {
    Set-Location ../Guard.WPF
    dotnet publish -r win-x64 -c Release --p:PublishSingleFile=true --self-contained true -o bin\publish
    Move-Item bin\publish\2FAGuard.exe "..\publish\bin\$WpfExeName" -Force
    dotnet publish -r win-x64 -c Release --p:PublishSingleFile=true --self-contained true -p:IsPortable=true -o bin\portable
    Move-Item bin\portable\2FAGuard.exe "..\publish\bin\$PortableExeName" -Force
    Set-Location ../publish
}

function Build-CLI-App {
    Set-Location ../Guard.CLI
    dotnet publish -r win-x64 -c Release --p:PublishSingleFile=true --self-contained true -o bin\publish
    Move-Item bin\publish\2fa.exe "..\publish\bin\$CliExeName" -Force
    Set-Location ../publish
}

function Invoke-Code-Signing {
    signtool.exe sign /sha1 43E9DD4D4A06853CBB521EA35E5F337EDB0DBCCD /t "http://time.certum.pl/" /fd sha256 /d "2FAGuard" /du "https://2faguard.app" ".\bin\$WpfExeName" ".\bin\$PortableExeName" ".\bin\$CliExeName"
}

function Build-Installer {
    Start-Process -NoNewWindow -FilePath "C:\Program Files (x86)\Inno Setup 6\ISCC.exe" -ArgumentList "./installer.iss"
}


Write-Host "Checking Requirements"
Confirm-Requirements

Write-Host "Running Tests"
Invoke-Tests

Write-Host "Building WPF App"
Build-WPF-App

Write-Host "Building CLI App"
Build-CLI-App

if ($dev) {
    Write-Host "Dev mode enabled, skipping signing and installer"
    Exit 0
}

Write-Host "Signing Code"
Invoke-Code-Signing

Write-Host "Building Installer"
Build-Installer
Write-Host "Done"

# SIG # Begin signature block
# MIIofAYJKoZIhvcNAQcCoIIobTCCKGkCAQExDzANBglghkgBZQMEAgEFADB5Bgor
# BgEEAYI3AgEEoGswaTA0BgorBgEEAYI3AgEeMCYCAwEAAAQQH8w7YFlLCE63JNLG
# KX7zUQIBAAIBAAIBAAIBAAIBADAxMA0GCWCGSAFlAwQCAQUABCCp8cC+wNBeVF4v
# d4srl6ksQc6ZD2pBTmGuE/inyezRI6CCILcwggXJMIIEsaADAgECAhAbtY8lKt8j
# AEkoya49fu0nMA0GCSqGSIb3DQEBDAUAMH4xCzAJBgNVBAYTAlBMMSIwIAYDVQQK
# ExlVbml6ZXRvIFRlY2hub2xvZ2llcyBTLkEuMScwJQYDVQQLEx5DZXJ0dW0gQ2Vy
# dGlmaWNhdGlvbiBBdXRob3JpdHkxIjAgBgNVBAMTGUNlcnR1bSBUcnVzdGVkIE5l
# dHdvcmsgQ0EwHhcNMjEwNTMxMDY0MzA2WhcNMjkwOTE3MDY0MzA2WjCBgDELMAkG
# A1UEBhMCUEwxIjAgBgNVBAoTGVVuaXpldG8gVGVjaG5vbG9naWVzIFMuQS4xJzAl
# BgNVBAsTHkNlcnR1bSBDZXJ0aWZpY2F0aW9uIEF1dGhvcml0eTEkMCIGA1UEAxMb
# Q2VydHVtIFRydXN0ZWQgTmV0d29yayBDQSAyMIICIjANBgkqhkiG9w0BAQEFAAOC
# Ag8AMIICCgKCAgEAvfl4+ObVgAxknYYblmRnPyI6HnUBfe/7XGeMycxca6mR5rlC
# 5SBLm9qbe7mZXdmbgEvXhEArJ9PoujC7Pgkap0mV7ytAJMKXx6fumyXvqAoAl4Va
# qp3cKcniNQfrcE1K1sGzVrihQTib0fsxf4/gX+GxPw+OFklg1waNGPmqJhCrKtPQ
# 0WeNG0a+RzDVLnLRxWPa52N5RH5LYySJhi40PylMUosqp8DikSiJucBb+R3Z5yet
# /5oCl8HGUJKbAiy9qbk0WQq/hEr/3/6zn+vZnuCYI+yma3cWKtvMrTscpIfcRnNe
# GWJoRVfkkIJCu0LW8GHgwaM9ZqNd9BjuiMmNF0UpmTJ1AjHuKSbIawLmtWJFfzcV
# WiNoidQ+3k4nsPBADLxNF8tNorMe0AZa3faTz1d1mfX6hhpneLO/lv403L3nUlbl
# s+V1e9dBkQXcXWnjlQ1DufyDljmVe2yAWk8TcsbXfSl6RLpSpCrVQUYJIP4ioLZb
# MI28iQzV13D4h1L92u+sUS4Hs07+0AnacO+Y+lbmbdu1V0vc5SwlFcieLnhO+Nqc
# noYsylfzGuXIkosagpZ6w7xQEmnYDlpGizrrJvojybawgb5CAKT41v4wLsfSRvbl
# jnX98sy50IdbzAYQYLuDNbdeZ95H7JlI8aShFf6tjGKOOVVPORa5sWOd/7cCAwEA
# AaOCAT4wggE6MA8GA1UdEwEB/wQFMAMBAf8wHQYDVR0OBBYEFLahVDkCw6A/joq8
# +tT4HKbROg79MB8GA1UdIwQYMBaAFAh2zcsH/yT2xc3tu5C84oQ3RnX3MA4GA1Ud
# DwEB/wQEAwIBBjAvBgNVHR8EKDAmMCSgIqAghh5odHRwOi8vY3JsLmNlcnR1bS5w
# bC9jdG5jYS5jcmwwawYIKwYBBQUHAQEEXzBdMCgGCCsGAQUFBzABhhxodHRwOi8v
# c3ViY2Eub2NzcC1jZXJ0dW0uY29tMDEGCCsGAQUFBzAChiVodHRwOi8vcmVwb3Np
# dG9yeS5jZXJ0dW0ucGwvY3RuY2EuY2VyMDkGA1UdIAQyMDAwLgYEVR0gADAmMCQG
# CCsGAQUFBwIBFhhodHRwOi8vd3d3LmNlcnR1bS5wbC9DUFMwDQYJKoZIhvcNAQEM
# BQADggEBAFHCoVgWIhCL/IYx1MIy01z4S6Ivaj5N+KsIHu3V6PrnCA3st8YeDrJ1
# BXqxC/rXdGoABh+kzqrya33YEcARCNQOTWHFOqj6seHjmOriY/1B9ZN9DbxdkjuR
# mmW60F9MvkyNaAMQFtXx0ASKhTP5N+dbLiZpQjy6zbzUeulNndrnQ/tjUoCFBMQl
# lVXwfqefAcVbKPjgzoZwpic7Ofs4LphTZSJ1Ldf23SIikZbr3WjtP6MZl9M7JYjs
# NhI9qX7OAo0FmpKnJ25FspxihjcNpDOO16hO0EoXQ0zF8ads0h5YbBRRfopUofbv
# n3l6XYGaFpAP4bvxSgD5+d2+7arszgowggaDMIIEa6ADAgECAhEAnpwE9lWotKcC
# bUmMbHiNqjANBgkqhkiG9w0BAQwFADBWMQswCQYDVQQGEwJQTDEhMB8GA1UEChMY
# QXNzZWNvIERhdGEgU3lzdGVtcyBTLkEuMSQwIgYDVQQDExtDZXJ0dW0gVGltZXN0
# YW1waW5nIDIwMjEgQ0EwHhcNMjUwMTA5MDg0MDQzWhcNMzYwMTA3MDg0MDQzWjBQ
# MQswCQYDVQQGEwJQTDEhMB8GA1UECgwYQXNzZWNvIERhdGEgU3lzdGVtcyBTLkEu
# MR4wHAYDVQQDDBVDZXJ0dW0gVGltZXN0YW1wIDIwMjUwggIiMA0GCSqGSIb3DQEB
# AQUAA4ICDwAwggIKAoICAQDHKV9n+Kwr3ZBF5UCLWOQ/NdbblAvQeGMjfCi/bibT
# 71hPkwKV4UvQt1MuOwoaUCYtsLhw8jrmOmoz2HoHKKzEpiS3A1rA3ssXUZMnSrbi
# iVpDj+5MtnbXSVEJKbccuHbmwcjl39N4W72zccoC/neKAuwO1DJ+9SO+YkHncRiV
# 95idWhxRAcDYv47hc9GEFZtTFxQXLbrL4N7N90BqLle3ayznzccEPQ+E6H6p00zE
# 9HUp++3bZTF4PfyPRnKCLc5ezAzEqqbbU5F/nujx69T1mm02jltlFXnTMF1vlake
# QXWYpGIjtrR7WP7tIMZnk78nrYSfeAp8le+/W/5+qr7tqQZufW9invsRTcfk7P+m
# nKjJLuSbwqgxelvCBryz9r51bT0561aR2c+joFygqW7n4FPCnMLOj40X4ot7wP2u
# 8kLRDVHbhsHq5SGLqr8DbFq14ws2ALS3tYa2GGiA7wX79rS5oDMnSY/xmJO5cupu
# SvqpylzO7jzcLOwWiqCrq05AXp51SRrj9xRt8KdZWpDdWhWmE8MFiFtmQ0AqODLJ
# Bn1hQAx3FvD/pte6pE1Bil0BOVC2Snbeq/3NylDwvDdAg/0CZRJsQIaydHswJwyY
# BlYUDyaQK2yUS57hobnYx/vStMvTB96ii4jGV3UkZh3GvwdDCsZkbJXaU8ATF/z6
# DwIDAQABo4IBUDCCAUwwdQYIKwYBBQUHAQEEaTBnMDsGCCsGAQUFBzAChi9odHRw
# Oi8vc3ViY2EucmVwb3NpdG9yeS5jZXJ0dW0ucGwvY3RzY2EyMDIxLmNlcjAoBggr
# BgEFBQcwAYYcaHR0cDovL3N1YmNhLm9jc3AtY2VydHVtLmNvbTAfBgNVHSMEGDAW
# gBS+VAIvv0Bsc0POrAklTp5DRBru4DAMBgNVHRMBAf8EAjAAMDkGA1UdHwQyMDAw
# LqAsoCqGKGh0dHA6Ly9zdWJjYS5jcmwuY2VydHVtLnBsL2N0c2NhMjAyMS5jcmww
# FgYDVR0lAQH/BAwwCgYIKwYBBQUHAwgwDgYDVR0PAQH/BAQDAgeAMCIGA1UdIAQb
# MBkwCAYGZ4EMAQQCMA0GCyqEaAGG9ncCBQELMB0GA1UdDgQWBBSBjAagKFP8AD/b
# fp5KwR8i7LISiTANBgkqhkiG9w0BAQwFAAOCAgEAmQ8ZDBvrBUPnaL87AYc4Jlmf
# H1ZP5yt65MtzYu8fbmsL3d3cvYs+Enbtfu9f2wMehzSyved3Rc59a04O8NN7plw4
# PXg71wfSE4MRFM1EuqL63zq9uTjm/9tA73r1aCdWmkprKp0aLoZolUN0qGcvr9+Q
# G8VIJVMcuSqFeEvRrLEKK2xVkMSdTTbDhseUjI4vN+BrXm5z45EA3aDpSiZQuoNd
# 4RFnDzddbgfcCQPaY2UyXqzNBjnuz6AyHnFzKtNlCevkMBgh4dIDt/0DGGDOaTEA
# WZtUEqK5AlHd0PBnd40Lnog4UATU3Bt6GHfeDmWEHFTjHKsmn9Q8wiGj906bVgL8
# 35tfEH9EgYDklqrOUxWxDf1cOA7ds/r8pIc2vjLQ9tOSkm9WXVbnTeLG3Q57frTg
# CvTObd/qf3UzE97nTNOU7vOMZEo41AgmhuEbGsyQIDM/V6fJQX1RnzzJNoqfTTkU
# zUoP2tlNHnNsjFo2YV+5yZcoaawmNWmR7TywUXG2/vFgJaG0bfEoodeeXp7A4I4H
# aDDpfRa7ypgJEPeTwHuBRJpj9N+1xtri+6BzHPwsAAvUJm58PGoVsteHAXwvpg4N
# VgvUk3BKbl7xFulWU1KHqH/sk7T0CFBQ5ohuKPmFf1oqAP4AO9a3Yg2wBMwEg1zP
# Oh6xbUXskzs9iSa9yGwwgga5MIIEoaADAgECAhEAmaOACiZVO2Wr3G6EprPqOTAN
# BgkqhkiG9w0BAQwFADCBgDELMAkGA1UEBhMCUEwxIjAgBgNVBAoTGVVuaXpldG8g
# VGVjaG5vbG9naWVzIFMuQS4xJzAlBgNVBAsTHkNlcnR1bSBDZXJ0aWZpY2F0aW9u
# IEF1dGhvcml0eTEkMCIGA1UEAxMbQ2VydHVtIFRydXN0ZWQgTmV0d29yayBDQSAy
# MB4XDTIxMDUxOTA1MzIxOFoXDTM2MDUxODA1MzIxOFowVjELMAkGA1UEBhMCUEwx
# ITAfBgNVBAoTGEFzc2VjbyBEYXRhIFN5c3RlbXMgUy5BLjEkMCIGA1UEAxMbQ2Vy
# dHVtIENvZGUgU2lnbmluZyAyMDIxIENBMIICIjANBgkqhkiG9w0BAQEFAAOCAg8A
# MIICCgKCAgEAnSPPBDAjO8FGLOczcz5jXXp1ur5cTbq96y34vuTmflN4mSAfgLKT
# vggv24/rWiVGzGxT9YEASVMw1Aj8ewTS4IndU8s7VS5+djSoMcbvIKck6+hI1shs
# ylP4JyLvmxwLHtSworV9wmjhNd627h27a8RdrT1PH9ud0IF+njvMk2xqbNTIPsnW
# tw3E7DmDoUmDQiYi/ucJ42fcHqBkbbxYDB7SYOouu9Tj1yHIohzuC8KNqfcYf7Z4
# /iZgkBJ+UFNDcc6zokZ2uJIxWgPWXMEmhu1gMXgv8aGUsRdaCtVD2bSlbfsq7Biq
# ljjaCun+RJgTgFRCtsuAEw0pG9+FA+yQN9n/kZtMLK+Wo837Q4QOZgYqVWQ4x6cM
# 7/G0yswg1ElLlJj6NYKLw9EcBXE7TF3HybZtYvj9lDV2nT8mFSkcSkAExzd4prHw
# YjUXTeZIlVXqj+eaYqoMTpMrfh5MCAOIG5knN4Q/JHuurfTI5XDYO962WZayx7AC
# Ff5ydJpoEowSP07YaBiQ8nXpDkNrUA9g7qf/rCkKbWpQ5boufUnq1UiYPIAHlezf
# 4muJqxqIns/kqld6JVX8cixbd6PzkDpwZo4SlADaCi2JSplKShBSND36E/ENVv8u
# rPS0yOnpG4tIoBGxVCARPCg1BnyMJ4rBJAcOSnAWd18Jx5n858JSqPECAwEAAaOC
# AVUwggFRMA8GA1UdEwEB/wQFMAMBAf8wHQYDVR0OBBYEFN10XUwA23ufoHTKsW73
# PMAywHDNMB8GA1UdIwQYMBaAFLahVDkCw6A/joq8+tT4HKbROg79MA4GA1UdDwEB
# /wQEAwIBBjATBgNVHSUEDDAKBggrBgEFBQcDAzAwBgNVHR8EKTAnMCWgI6Ahhh9o
# dHRwOi8vY3JsLmNlcnR1bS5wbC9jdG5jYTIuY3JsMGwGCCsGAQUFBwEBBGAwXjAo
# BggrBgEFBQcwAYYcaHR0cDovL3N1YmNhLm9jc3AtY2VydHVtLmNvbTAyBggrBgEF
# BQcwAoYmaHR0cDovL3JlcG9zaXRvcnkuY2VydHVtLnBsL2N0bmNhMi5jZXIwOQYD
# VR0gBDIwMDAuBgRVHSAAMCYwJAYIKwYBBQUHAgEWGGh0dHA6Ly93d3cuY2VydHVt
# LnBsL0NQUzANBgkqhkiG9w0BAQwFAAOCAgEAdYhYD+WPUCiaU58Q7EP89DttyZqG
# Yn2XRDhJkL6P+/T0IPZyxfxiXumYlARMgwRzLRUStJl490L94C9LGF3vjzzH8Jq3
# iR74BRlkO18J3zIdmCKQa5LyZ48IfICJTZVJeChDUyuQy6rGDxLUUAsO0eqeLNhL
# Vsgw6/zOfImNlARKn1FP7o0fTbj8ipNGxHBIutiRsWrhWM2f8pXdd3x2mbJCKKtl
# 2s42g9KUJHEIiLni9ByoqIUul4GblLQigO0ugh7bWRLDm0CdY9rNLqyA3ahe8Wlx
# VWkxyrQLjH8ItI17RdySaYayX3PhRSC4Am1/7mATwZWwSD+B7eMcZNhpn8zJ+6MT
# yE6YoEBSRVrs0zFFIHUR08Wk0ikSf+lIe5Iv6RY3/bFAEloMU+vUBfSouCReZwSL
# o8WdrDlPXtR0gicDnytO7eZ5827NS2x7gCBibESYkOh1/w1tVxTpV2Na3PR7nxYV
# lPu1JPoRZCbH86gc96UTvuWiOruWmyOEMLOGGniR+x+zPF/2DaGgK2W1eEJfo2qy
# rBNPvF7wuAyQfiFXLwvWHamoYtPZo0LHuH8X3n9C+xN4YaNjt2ywzOr+tKyEVAot
# nyU9vyEVOaIYMk3IeBrmFnn0gbKeTTyYeEEUz/Qwt4HOUBCrW602NCmvO1nm+/80
# nLy5r0AZvCQxaQ4wgga5MIIEoaADAgECAhEA5/9pxzs1zkuRJth0fGilhzANBgkq
# hkiG9w0BAQwFADCBgDELMAkGA1UEBhMCUEwxIjAgBgNVBAoTGVVuaXpldG8gVGVj
# aG5vbG9naWVzIFMuQS4xJzAlBgNVBAsTHkNlcnR1bSBDZXJ0aWZpY2F0aW9uIEF1
# dGhvcml0eTEkMCIGA1UEAxMbQ2VydHVtIFRydXN0ZWQgTmV0d29yayBDQSAyMB4X
# DTIxMDUxOTA1MzIwN1oXDTM2MDUxODA1MzIwN1owVjELMAkGA1UEBhMCUEwxITAf
# BgNVBAoTGEFzc2VjbyBEYXRhIFN5c3RlbXMgUy5BLjEkMCIGA1UEAxMbQ2VydHVt
# IFRpbWVzdGFtcGluZyAyMDIxIENBMIICIjANBgkqhkiG9w0BAQEFAAOCAg8AMIIC
# CgKCAgEA6RIfBDXtuV16xaaVQb6KZX9Od9FtJXXTZo7b+GEof3+3g0ChWiKnO7R4
# +6MfrvLyLCWZa6GpFHjEt4t0/GiUQvnkLOBRdBqr5DOvlmTvJJs2X8ZmWgWJjC7P
# BZLYBWAs8sJl3kNXxBMX5XntjqWx1ZOuuXl0R4x+zGGSMzZ45dpvB8vLpQfZkfMC
# /1tL9KYyjU+htLH68dZJPtzhqLBVG+8ljZ1ZFilOKksS79epCeqFSeAUm2eMTGpO
# iS3gfLM6yvb8Bg6bxg5yglDGC9zbr4sB9ceIGRtCQF1N8dqTgM/dSViiUgJkcv5d
# LNJeWxGCqJYPgzKlYZTgDXfGIeZpEFmjBLwURP5ABsyKoFocMzdjrCiFbTvJn+bD
# 1kq78qZUgAQGGtd6zGJ88H4NPJ5Y2R4IargiWAmv8RyvWnHr/VA+2PrrK9eXe5q7
# M88YRdSTq9TKbqdnITUgZcjjm4ZUjteq8K331a4P0s2in0p3UubMEYa/G5w6jSWP
# UzchGLwWKYBfeSu6dIOC4LkeAPvmdZxSB1lWOb9HzVWZoM8Q/blaP4LWt6JxjkI9
# yQsYGMdCqwl7uMnPUIlcExS1mzXRxUowQref/EPaS7kYVaHHQrp4XB7nTEtQhkP0
# Z9Puz/n8zIFnUSnxDof4Yy650PAXSYmK2TcbyDoTNmmt8xAxzcMCAwEAAaOCAVUw
# ggFRMA8GA1UdEwEB/wQFMAMBAf8wHQYDVR0OBBYEFL5UAi+/QGxzQ86sCSVOnkNE
# Gu7gMB8GA1UdIwQYMBaAFLahVDkCw6A/joq8+tT4HKbROg79MA4GA1UdDwEB/wQE
# AwIBBjATBgNVHSUEDDAKBggrBgEFBQcDCDAwBgNVHR8EKTAnMCWgI6Ahhh9odHRw
# Oi8vY3JsLmNlcnR1bS5wbC9jdG5jYTIuY3JsMGwGCCsGAQUFBwEBBGAwXjAoBggr
# BgEFBQcwAYYcaHR0cDovL3N1YmNhLm9jc3AtY2VydHVtLmNvbTAyBggrBgEFBQcw
# AoYmaHR0cDovL3JlcG9zaXRvcnkuY2VydHVtLnBsL2N0bmNhMi5jZXIwOQYDVR0g
# BDIwMDAuBgRVHSAAMCYwJAYIKwYBBQUHAgEWGGh0dHA6Ly93d3cuY2VydHVtLnBs
# L0NQUzANBgkqhkiG9w0BAQwFAAOCAgEAuJNZd8lMFf2UBwigp3qgLPBBk58BFCS3
# Q6aJDf3TISoytK0eal/JyCB88aUEd0wMNiEcNVMbK9j5Yht2whaknUE1G32k6uld
# 7wcxHmw67vUBY6pSp8QhdodY4SzRRaZWzyYlviUpyU4dXyhKhHSncYJfa1U75cXx
# Ce3sTp9uTBm3f8Bj8LkpjMUSVTtMJ6oEu5JqCYzRfc6nnoRUgwz/GVZFoOBGdrSE
# tDN7mZgcka/tS5MI47fALVvN5lZ2U8k7Dm/hTX8CWOw0uBZloZEW4HB0Xra3qE4q
# zzq/6M8gyoU/DE0k3+i7bYOrOk/7tPJg1sOhytOGUQ30PbG++0FfJioDuOFhj99b
# 151SqFlSaRQYz74y/P2XJP+cF19oqozmi0rRTkfyEJIvhIZ+M5XIFZttmVQgTxfp
# fJwMFFEoQrSrklOxpmSygppsUDJEoliC05vBLVQ+gMZyYaKvBJ4YxBMlKH5ZHkRd
# loRYlUDplk8GUa+OCMVhpDSQurU6K1ua5dmZftnvSSz2H96UrQDzA6DyiI1V3ejV
# tvn2azVAXg6NnjmuRZ+wa7Pxy0H3+V4K4rOTHlG3VYA6xfLsTunCz72T6Ot4+tkr
# DYOeaU1pPX1CBfYj6EW2+ELq46GP8KCNUQDirWLU4nOmgCat7vN0SD6RlwUiSsMe
# CiQDmZwgwrUwggblMIIEzaADAgECAhBDIrrcCXc2Gu8H/DZVR42UMA0GCSqGSIb3
# DQEBCwUAMFYxCzAJBgNVBAYTAlBMMSEwHwYDVQQKExhBc3NlY28gRGF0YSBTeXN0
# ZW1zIFMuQS4xJDAiBgNVBAMTG0NlcnR1bSBDb2RlIFNpZ25pbmcgMjAyMSBDQTAe
# Fw0yNjAyMDExMDAyMDJaFw0yNzAyMDExMDAyMDFaMIGKMQswCQYDVQQGEwJERTEc
# MBoGA1UECAwTTm9yZHJoZWluLVdlc3RmYWxlbjEOMAwGA1UEBwwFV2VzZWwxHjAc
# BgNVBAoMFU9wZW4gU291cmNlIERldmVsb3BlcjEtMCsGA1UEAwwkT3BlbiBTb3Vy
# Y2UgRGV2ZWxvcGVyLCBUaW1vIEvDtnNzbGVyMIICIjANBgkqhkiG9w0BAQEFAAOC
# Ag8AMIICCgKCAgEA1wpvok2h06vL6pZDRWqi7tE1gZHKzpQ+HqYMpzXGlAZqvHsu
# BHvgNvg7eHzLjPHEA8jxqvyht5UXjaVPEU2xxIdWGWLS4SxVYjA75odkj/YIrkA2
# qXUIri6rlZ9/c9HZVHxfmk9sl9LZ2UVnL5J/YWtx2JR15olxvmSQZqB99RPyH+sQ
# 1tSeY2U+EvEmoRR4xmEvGrcmapPI7Ls3v1subXKjH5CudIb89/W8u8YtD4LSfrcr
# rElBb/MUeEPVDor3eg2jxJl4gv+/AtbD9OYv4RFeTnJVjndnpHfRiaCUqS9BR74l
# UX9/dYy2Ww6M02PbjYZWZqFOsJgorf9e5u0+oGNgD99FglH7TsY268fkcrsq09XA
# 3LDHOU6A9SId5snvvQQ8R8izLGrhn42Ej0WbzTxiY8zuX6DHmc1WvTmmJ35mE89l
# gEnn3wK0g+dSiA9soqY/mxmFKRhrmikFyQ4Nux8qAHpZRS/+TnXudH5aZjtHbLFO
# y0wU7llJj3Ox9NB0Bn7UXVM1A92+bNCFgaTeRls/z9+5e/5znO/WYYFQy0/WTV8c
# 7wyzLuFZRfjFVj2ih/jTLF5WK8JLR6BBVqfi+SRI63QTuuIVModpySlzrcNoQNHS
# D0XJ/S2buyINRLWupLmA4gpSHH5T4bQXXRfWaC+HwkSJN3gHFzMKc/wEPCECAwEA
# AaOCAXgwggF0MAwGA1UdEwEB/wQCMAAwPQYDVR0fBDYwNDAyoDCgLoYsaHR0cDov
# L2Njc2NhMjAyMS5jcmwuY2VydHVtLnBsL2Njc2NhMjAyMS5jcmwwcwYIKwYBBQUH
# AQEEZzBlMCwGCCsGAQUFBzABhiBodHRwOi8vY2NzY2EyMDIxLm9jc3AtY2VydHVt
# LmNvbTA1BggrBgEFBQcwAoYpaHR0cDovL3JlcG9zaXRvcnkuY2VydHVtLnBsL2Nj
# c2NhMjAyMS5jZXIwHwYDVR0jBBgwFoAU3XRdTADbe5+gdMqxbvc8wDLAcM0wHQYD
# VR0OBBYEFGvcxTTq03ejOZ//ve5Cp3Hfdr3vMEsGA1UdIAREMEIwCAYGZ4EMAQQB
# MDYGCyqEaAGG9ncCBQEEMCcwJQYIKwYBBQUHAgEWGWh0dHBzOi8vd3d3LmNlcnR1
# bS5wbC9DUFMwEwYDVR0lBAwwCgYIKwYBBQUHAwMwDgYDVR0PAQH/BAQDAgeAMA0G
# CSqGSIb3DQEBCwUAA4ICAQAjvbYNcqq4/vNSK59D70iO8UcJdndWtgSjZUa8F0eE
# bHKxUl+D9hQCdZuQmUd7K/XFgwRzsn0Ec7owf9oMa3McnZ3PVvFqzPeGq26nEdgK
# ck1qsUOAsVXydH2o5XgXNbbtw5+QO6yKCVI58HDPrt2ZKSFAH6wKKZRJPEn3yLvP
# Xl6HuSzMoyK4yU1B+13coLUfYP3Lht1hhbwf6+gDEqXRtdh1V8Op45HyMRr4mVfc
# mWNSKFbNhwis/wsjKfamI2ONtwNJEf6K3QlRxVXyL/K3plg9nLZCg3xwIaKAfS5m
# 27wz3GYfidcxHqgDXtudn4NFJN1EWaAPVf5SlkRJJEjg120PU40an+xdGoYDfIfJ
# +VQGnkxLdTXb0gmNFaCVQPSQE/GxHuFqsniuxdszsNb5bQv+vUXFBTmhIXBEKEuF
# j/mCn53Jl8g0jIqGXT0W4pxkRrCeVCL+vMSJsb7IP5152LgpXTko7lP3qgz6WOsP
# 3GsWnatSwKDNWU0+sODn92IxaoO726rA78Lk2Ox/3gbCDaC6ij4KR5nNg3BkGcE/
# lGP8MtZe/hj8LWWYbKFy3jlAHEY7uGF1KlFJcuOj3oyGYHdiXvhRo3j5AwjiXmHZ
# ajToBOFyTZf6W0LcNkBB6s/fTlQwerCRSXVMVs+0xAEi+fnXjRw9l/Xek+sljG7Q
# 5jGCBxswggcXAgEBMGowVjELMAkGA1UEBhMCUEwxITAfBgNVBAoTGEFzc2VjbyBE
# YXRhIFN5c3RlbXMgUy5BLjEkMCIGA1UEAxMbQ2VydHVtIENvZGUgU2lnbmluZyAy
# MDIxIENBAhBDIrrcCXc2Gu8H/DZVR42UMA0GCWCGSAFlAwQCAQUAoHwwEAYKKwYB
# BAGCNwIBDDECMAAwGQYJKoZIhvcNAQkDMQwGCisGAQQBgjcCAQQwHAYKKwYBBAGC
# NwIBCzEOMAwGCisGAQQBgjcCARUwLwYJKoZIhvcNAQkEMSIEIKofUq+NZlzhDex6
# mI5A8B2CwoQqUO/guUQ9xJDwLQblMA0GCSqGSIb3DQEBAQUABIICAHeJCy/Fld2y
# LcPcp+sOJXWwF0B3t7SWhMvXd2mLTRKOVhPGwNckZw3bufh8IKY42Vy8wUBrxLrW
# gEyHw1tPMI6vrOu2n+e3hXYEdg9gL/oCnD5FQl5sZ6ew3TK/B7EXN55pHK0yncE7
# ZqazJxAu1uughXhkyCsKZ4jc4zEwhE/BMLGl1sN0qtxzT1Cm77T/b4MjRZyrH8Up
# 6VV2AXqZESgZjYxOofWDcsE7vZN1ZBrFEnk8BB2bh+sboxjPadPkRth2N6pcO2I9
# tMgr+pmyANh2TgDke0j6wADC7PR1ciHIBqEKst3J4bBD2Rbe9MHnavVjzl2CrNRX
# iwr9LS6ZN/UF6O4Lov+F0uJshg5JPMsg1uYlcqGoqqJdlH6UIwIfT86zjq3KR+D2
# YG5mxtjHJ4GPTtnHiaH6J6MpoKHUP6bQxzUAcJ+uo/86AnKORUxK5K/BFcaA0JYO
# vcvBZ+d3t2D8kY3m2cl+hjbv0WZ44MFtawgAxYohamLizcJ6elkt5pb62SchiE1i
# MxFj/WLQK9XBJ9LHwmgMvmtnS/BOvbrLKlfIVNHo6gm0xubFMuE3Slf2/I1yCm9q
# mYM/1UBHkIm3UBl7i2mJrUu0DMcMWaJdR6dCCNY3xP9dW/dpBzdjEoZnDeIE0wXp
# 7vFtpBD6XJ+21EGm5KDJlupMEc9OyUtroYIEBDCCBAAGCSqGSIb3DQEJBjGCA/Ew
# ggPtAgEBMGswVjELMAkGA1UEBhMCUEwxITAfBgNVBAoTGEFzc2VjbyBEYXRhIFN5
# c3RlbXMgUy5BLjEkMCIGA1UEAxMbQ2VydHVtIFRpbWVzdGFtcGluZyAyMDIxIENB
# AhEAnpwE9lWotKcCbUmMbHiNqjANBglghkgBZQMEAgIFAKCCAVcwGgYJKoZIhvcN
# AQkDMQ0GCyqGSIb3DQEJEAEEMBwGCSqGSIb3DQEJBTEPFw0yNjAyMDExMDIwNTVa
# MDcGCyqGSIb3DQEJEAIvMSgwJjAkMCIEIM+h3DWd7SvDy4kPojDl2vd7VA8abisj
# 3c8XVOGM+qDVMD8GCSqGSIb3DQEJBDEyBDBKDD+emk1WwBKU7CN8tl9nfGYcoX6P
# ACHodoHgtT0d600/v3ck9LrcwSPX64rU8c0wgaAGCyqGSIb3DQEJEAIMMYGQMIGN
# MIGKMIGHBBTDJbibF/zFAmBhzitxe0UH3ZxqajBvMFqkWDBWMQswCQYDVQQGEwJQ
# TDEhMB8GA1UEChMYQXNzZWNvIERhdGEgU3lzdGVtcyBTLkEuMSQwIgYDVQQDExtD
# ZXJ0dW0gVGltZXN0YW1waW5nIDIwMjEgQ0ECEQCenAT2Vai0pwJtSYxseI2qMA0G
# CSqGSIb3DQEBAQUABIICAEpYkQ8j96Py9Iw9Vypa1cBsPSzM02dI8fk89Do+VruK
# zKc4/cSJKL8oKohRML0/m/lzj7uj3H79MJDKK9eZcfuuNNOf/pHs4Gjn0eef22d3
# yRczQ5vTHSWHl7ZSl1BlXoZ4AO3Sp8CdZzitTFxr08gp2ZuWc7/ZkEa6E0+J2G4U
# MztjCPPirh5fcRaXQjHuqyucAnWB2xhyy2MtTvQT9eDtXJNoGUFsBvBi0Rgwunl+
# 9wgzuvyR1dIPnPrPYmdA60A9N2+Hr0DlmwnLr1SJtXcbliR+PNr/Ju9I1Bcxf2YU
# PI4zQFyms2Q1j0lqF8wH7eHzVtSXGwA3EfofMA69JbCYn74kp+Jts7CHegUgszB7
# 0oyYCHgH25jvXfmvPZNsvPXahmV1JqceFm8P0VCgoziErqJl43AaA2bcvZtCXK87
# 3p24yiruCC26FHcygilJ7I+XTZGMQloSnmfQ6PN0R3dHKXXBIoqXYq8XbDiUwAQO
# 874NVF1u0yUAZxIxACZQsYNNV1TlcJ5G9bTBFopwoyQqqKto9Cle5zNVWfVPWeXq
# Zk09OMY4fPHjebvm5i0WhsUiGblxGYW9ePOxy+oo6zSo+IKfkE34khDYQX/Imd1g
# M4TzqkF0b6XCN8Vvf3GI5ON5i2iwRPQIMHgVBSfndLU6D6k4aKj3xhdQt8R8/fPi
# SIG # End signature block
